!function(a){"use strict";a.namespace||(a.namespace=function(b){for(var c=b.split("."),d=a,e="",f=0,g=c.length;g>f;f++)e=c[f],d[e]=d[e]||{},d=d[e];return d})}(window),function(a,b){"use-strict";var c=namespace("ATS");b.extend(c,{app:b.module("ats",["ngRoute","ngMaterial","firebase"]),firebase:new Firebase("https://sweltering-torch-73.firebaseio.com/")})}(window,window.angular),function(a,b){"use-strict";var c=namespace("ATS.PlanningPoker");b.extend(c,{calculateVoteCompletion:function(a){var c=0,d=0;return b.forEach(a,function(a){a.voter&&(d++,a.vote&&c++)}),d?100*c/d:0},getConsensusLevel:function(a,b){return 1!==a.length?"Too Close To Call":1===b?"Unanimous":b>=.75?"Consensus":b>=.5?"Majority":"Plurality"},getMedianVote:function(a){var b=this.mapVotesOrdinal(a);return 0===b.length?[]:b.length%2===0?[b[b.length/2]]:[b[Math.floor(b.length/2)]]},getResults:function(a,b){return"ordinal"===b.type?this.getResultsOrdinal(a):this.getResultsNominal(a)},getResultsNominal:function(a){var c=this.mapVotesNominal(a),d=0,e=[],f=0;return b.forEach(c,function(a){d+=a.count,a.count>f?(e=[a.card],f=a.count):a.count===f&&e.push(a.card)}),{consensusLevel:this.getConsensusLevel(e,f/d),cards:e}},getResultsOrdinal:function(a){return{consensusLevel:"Best Guess (Median)",cards:this.getMedianVote(a)}},mapVotesNominal:function(a){var c={};return b.forEach(a,function(a){a.vote&&(c[a.vote.text]?c[a.vote.text].count++:c[a.vote.text]={card:a.vote,count:1})}),c},mapVotesOrdinal:function(a){var c=[];return b.forEach(a,function(a){a.vote&&a.vote.val>=0&&c.push(a.vote)}),c.sort(function(a,b){return a.val<=b.val?-1:1}),c}})}(window,window.angular),function(a,b){"use-strict";var c=namespace("ATS.PlanningPoker");b.extend(c,{Decks:[{name:"Mountain Goat",type:"ordinal",cards:[{text:"0",val:0},{text:".5",val:.5},{text:"1",val:1},{text:"2",val:2},{text:"3",val:3},{text:"5",val:5},{text:"8",val:8},{text:"13",val:13},{text:"20",val:20},{text:"40",val:40},{text:"100",val:100},{text:"?",val:-1},{text:"coffee",val:-2,fa:"coffee"}]},{name:"Fibonacci",type:"ordinal",cards:[{text:"0",val:0},{text:"1",val:1},{text:"2",val:2},{text:"3",val:3},{text:"5",val:5},{text:"8",val:8},{text:"13",val:13},{text:"21",val:21},{text:"34",val:34},{text:"55",val:55},{text:"89",val:89},{text:"?",val:-1},{text:"coffee",val:-2,fa:"coffee"}]},{name:"Sequential",type:"ordinal",cards:[{text:"0",val:0},{text:"1",val:1},{text:"2",val:2},{text:"3",val:3},{text:"4",val:4},{text:"5",val:5},{text:"6",val:6},{text:"7",val:7},{text:"8",val:8},{text:"9",val:9},{text:"10",val:10},{text:"?",val:-1},{text:"coffee",val:-2,fa:"coffee"}]},{name:"T-Shirt",type:"ordinal",cards:[{text:"XS",val:1},{text:"S",val:2},{text:"M",val:3},{text:"L",val:4},{text:"XL",val:5},{text:"?",val:-1},{text:"coffee",val:-2,fa:"coffee"}]},{name:"Lunch Plans",type:"nominal",cards:[{text:"Pizza",val:1},{text:"Asian",val:2},{text:"Burgers",val:3},{text:"Sandwiches",val:4},{text:"Greek",val:5},{text:"?",val:-1},{text:"coffee",val:-2,fa:"coffee"}]},{name:"Charities",type:"nominal",cards:[{text:"MN Armed Forces",val:1},{text:"Humane Society",val:2},{text:"Pride in Living",val:3},{text:"Second Harvest",val:4},{text:"Conservation MN",val:5},{text:"Leonardo's Basement",val:6}]}]})}(window,window.angular),function(){"use-strict";ATS.app.config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("blue").warnPalette("grey")}])}(window,window.angular),function(){"use-strict";ATS.app.config(["$routeProvider",function(a){a.when("/",{controller:"LandingCtrl",templateUrl:"views/landing.html"}).when("/:roomId/",{controller:"RoomCtrl",templateUrl:"views/room.html"}).otherwise({redirectTo:"/"})}])}(window,window.angular),function(){"use-strict";ATS.app.factory("RoomHelper",["$q","$firebase",function(a,b){return{checkIfRoomExists:function(b){var c=a.defer();return ATS.firebase.child("rooms").child(b).once("value",function(a){exists=null!==a.val(),c.resolve(exists)}),c.promise},generateRoomId:function(){return Math.floor(999e5*Math.random()+1e5).toString()},generateUserId:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},getRoom:function(a){var c=ATS.firebase.child("rooms").child(a);return b(c).$asObject()},getUser:function(a,c){var d=ATS.firebase.child("rooms").child(a).child("users").child(c);return b(d).$asObject()},newRoom:function(a,c){b(ATS.firebase.child("rooms").child(a)).$set({deckIndex:c,reveal:!1,updatedAt:Firebase.ServerValue.TIMESTAMP})},newUser:function(a,c,d){b(ATS.firebase.child("rooms").child(a).child("users").child(c)).$set({leader:d,vote:null,voter:!0})}}}])}(window,window.angular),function(){"use-strict";ATS.app.controller("LandingCtrl",["$rootScope","$scope","$location","$firebase","RoomHelper",function(a,b,c,d,e){b.joinRoom=function(){c.path("/"+b.roomId)},b.newRoom=function(){var b=e.generateRoomId(),d=0;e.newRoom(b,d);var f=e.generateUserId(),g=!0;e.newUser(b,f,g),a.uuid=f,c.path("/"+b)}}])}(window,window.angular),function(a){"use-strict";ATS.app.controller("RoomCtrl",["$rootScope","$scope","$routeParams","$location","RoomHelper",function(b,c,d,e,f){function g(){for(var a in c.room.users)c.room.users[a].vote=null;c.room.reveal=!1,c.room.results=null}function h(){c.user.leader?ATS.firebase.child("rooms").child(c.room.$id).remove():ATS.firebase.child("rooms").child(c.room.$id).child("users").child(c.user.$id).remove(),b.uuid=null}c.changeDeck=function(){g(),c.room.updatedAt=Firebase.ServerValue.TIMESTAMP,c.room.$save()},c.chooseCard=function(a,b,d){c.user.voter&&(c.user.vote={val:a,text:b,fa:d||""},c.user.$save())},c.share=function(){document.getElementById("share").blur(),a.prompt("Invite others to the room by sharing this link:",a.location)},c.reset=function(){g(),c.room.updatedAt=Firebase.ServerValue.TIMESTAMP,c.room.$save(),document.getElementById("reset").blur()},c.reveal=function(){c.room.results=ATS.PlanningPoker.getResults(c.room.users,c.selectedDeck),c.room.reveal=!0,c.room.updatedAt=Firebase.ServerValue.TIMESTAMP,c.room.$save(),document.getElementById("reveal").blur()},c.toggleVoter=function(){c.user.$save()},c.$watch("room.deckIndex",function(){c.selectedDeck=ATS.PlanningPoker.Decks[c.room.deckIndex]}),c.$watch("room.users",function(){c.voteCompletion=ATS.PlanningPoker.calculateVoteCompletion(c.room.users)});var i=d.roomId,j=b.uuid;f.checkIfRoomExists(i).then(function(a){if(a){if(c.room=f.getRoom(i),!j){j=f.generateUserId();var b=!1;f.newUser(i,j,b)}c.user=f.getUser(i,j),c.cardDecks=ATS.PlanningPoker.Decks,c.selectedDeckIndex=0,c.voteCompletion=0,c.selectedDeck=ATS.PlanningPoker.Decks[c.selectedDeckIndex].cards}else e.path("/")}),c.$on("$locationChangeStart",function(){h()}),a.onbeforeunload=function(){h()},c.$on("$destroy",function(){delete a.onbeforeunload})}])}(window,window.angular);